import{j as e,l as t}from"./index-CNBhnEaq.js";import{r as s}from"./react-vendor-BU_GpymC.js";import{s as a,n as r}from"./notifications-GebQcT5-.js";import{A as l}from"./arrow-left-BrZexQs1.js";import{c as n}from"./createLucideIcon-BUt5drnH.js";import{P as o,a as i,T as c}from"./trash-2-CZWBVrde.js";import{S as d}from"./search-DSs--sQl.js";
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m=n("Code2",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]),x=n("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),h=n("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),u=({initialHtml:t="",initialCss:a="",onSave:r,onCancel:n,isSaving:o=!1})=>{const[i,c]=s.useState(!0),[d,u]=s.useState(t),[p,f]=s.useState(a),[g,b]=s.useState("html"),w='<div class="email-content">\n  <div class="header">\n    <h1>Welcome to StudyNet!</h1>\n  </div>\n  <div class="content">\n    <p>Dear {name},</p>\n    <p>Thank you for your interest in studying with us.</p>\n    <p>We look forward to helping you achieve your educational goals.</p>\n    <p>Best regards,<br>StudyNet Team</p>\n  </div>\n</div>',y="/* Add your CSS styles here */\n.email-content {\n  font-family: Arial, sans-serif;\n  max-width: 600px;\n  margin: 0 auto;\n  padding: 20px;\n  background: #ffffff;\n}\n\n.header {\n  background: #f5f5f5;\n  padding: 20px;\n  text-align: center;\n  border-radius: 4px;\n}\n\n.content {\n  padding: 20px 0;\n  line-height: 1.6;\n  color: #333333;\n}\n\nh1 {\n  color: #9b1f62;\n  margin: 0;\n}\n\np {\n  margin: 1em 0;\n}";return s.useEffect((()=>{d||p||(u(w),f(y))}),[]),e.jsx("div",{className:"min-h-screen bg-gradient-to-r from-[#9b1f62] via-[#682161] to-[#3e3764] py-4 sm:py-6 px-3 sm:px-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 sm:p-4 border-b gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 w-full sm:w-auto",children:[e.jsxs("button",{onClick:n,className:"flex items-center px-2 sm:px-3 py-1.5 text-sm text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(l,{className:"w-4 h-4 mr-1 sm:mr-2"}),"Back"]}),e.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-800",children:"Email Template Editor"})]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>c(!i),className:"flex-1 sm:flex-none flex items-center justify-center px-3 py-1.5 text-sm rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:i?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),"Preview"]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),"Code"]})}),e.jsxs("button",{onClick:()=>{r(d,p)},disabled:o,className:"flex-1 sm:flex-none flex items-center justify-center px-4 py-1.5 text-sm text-white bg-[#9b1f62] rounded-lg hover:bg-[#8a1b57] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),o?"Saving...":"Save"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 h-[calc(100vh-8rem)] lg:h-[calc(100vh-6rem)]",children:[i&&e.jsxs("div",{className:"border-b lg:border-b-0 lg:border-r border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{onClick:()=>b("html"),className:"flex-1 lg:flex-none px-4 py-2 text-sm font-medium "+("html"===g?"text-[#9b1f62] border-b-2 border-[#9b1f62]":"text-gray-500 hover:text-gray-700"),children:"HTML"}),e.jsx("button",{onClick:()=>b("css"),className:"flex-1 lg:flex-none px-4 py-2 text-sm font-medium "+("css"===g?"text-[#9b1f62] border-b-2 border-[#9b1f62]":"text-gray-500 hover:text-gray-700"),children:"CSS"})]})}),e.jsx("div",{className:"h-[calc(100%-41px)] p-3 sm:p-4",children:e.jsx("textarea",{value:"html"===g?d:p,onChange:e=>"html"===g?u(e.target.value):f(e.target.value),placeholder:"html"===g?w:y,className:"w-full h-full px-3 py-2 text-sm font-mono bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#9b1f62] focus:border-transparent resize-none",spellCheck:!1})})]}),e.jsx("div",{className:"h-full overflow-auto "+(i?"hidden lg:block":"block"),children:e.jsx("div",{className:"h-full p-3 sm:p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-3 sm:p-4 min-h-full",children:[e.jsx("style",{children:p}),e.jsx("div",{dangerouslySetInnerHTML:{__html:d},className:"prose max-w-none"})]})})})]})]})})})};
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function p(){const[l,n]=s.useState([]),[m,x]=s.useState(null),[h,p]=s.useState(!1),[f,g]=s.useState(!1),[b,w]=s.useState(""),[y,j]=s.useState(""),[v,N]=s.useState(!1),[C,k]=s.useState("");s.useEffect((()=>{S()}),[]);const S=async()=>{try{N(!0);const{data:e,error:t}=await a.from("email_templates").select("*").order("created_at",{ascending:!1});if(t)throw t;n(e||[])}catch(e){r.error("Error fetching templates: "+e.message),t.error("Error fetching templates:",e)}finally{N(!1)}},E=async(e,s)=>{if(m)try{N(!0);const{error:t}=await a.from("email_templates").update({html_content:e,css_content:s,updated_at:(new Date).toISOString()}).eq("id",m.id);if(t)throw t;r.success("Template saved successfully"),await S(),p(!1)}catch(l){r.error("Error saving template: "+l.message),t.error("Error saving template:",l)}finally{N(!1)}},_=()=>{w(""),j("")},T=l.filter((e=>e.name.toLowerCase().includes(C.toLowerCase())||e.subject.toLowerCase().includes(C.toLowerCase())));return h&&m?e.jsx(u,{initialHtml:m.html_content,initialCss:m.css_content,onSave:E,onCancel:()=>p(!1),isSaving:v}):e.jsx("div",{className:"min-h-screen bg-gradient-to-r from-[#9b1f62] via-[#682161] to-[#3e3764] py-4 sm:py-6 px-3 sm:px-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl shadow-lg p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 sm:gap-6 mb-4 sm:mb-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-white",children:"Email Templates"}),!f&&e.jsxs("button",{onClick:()=>g(!0),disabled:v,className:"w-full sm:w-auto px-4 py-2 bg-[#9b1f62] text-white text-sm sm:text-base rounded-lg hover:bg-[#8a1b57] transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:[e.jsx(o,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2"}),"New Template"]})]}),f?e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 sm:p-6",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold mb-4",children:"Create New Template"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template Name"}),e.jsx("input",{type:"text",value:b,onChange:e=>w(e.target.value),disabled:v,className:"w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#9b1f62] focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Enter template name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Line"}),e.jsx("input",{type:"text",value:y,onChange:e=>j(e.target.value),disabled:v,className:"w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#9b1f62] focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Enter email subject"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{g(!1),_()},disabled:v,className:"w-full sm:w-auto px-4 py-2 text-sm sm:text-base text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(b&&y)try{N(!0);const{data:{user:e},error:t}=await a.auth.getUser();if(t||!e)throw new Error("User not authenticated");const{data:s}=await a.from("email_templates").select("id").eq("name",b).single();if(s)return void r.error("A template with this name already exists");const{data:o,error:i}=await a.from("email_templates").insert({name:b,subject:y,html_content:"",css_content:"",created_by:e.id}).select().single();if(i)throw i;r.success("Template created successfully"),n([o,...l]),x(o),g(!1),p(!0),_()}catch(e){r.error("Error creating template: "+e.message),t.error("Error creating template:",e)}finally{N(!1)}else r.error("Please provide both template name and subject")},disabled:v||!b||!y,className:"w-full sm:w-auto px-4 py-2 text-sm sm:text-base text-white bg-[#9b1f62] rounded-lg hover:bg-[#8a1b57] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:v?"Creating...":"Create"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",value:C,onChange:e=>k(e.target.value),placeholder:"Search templates...",className:"w-full px-4 py-2 pl-10 text-sm sm:text-base bg-white/5 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-[#9b1f62] focus:border-transparent"}),e.jsx(d,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white/50 absolute left-3 top-1/2 -translate-y-1/2"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v&&0===T.length?e.jsx("div",{className:"col-span-full text-center py-8 text-white",children:"Loading templates..."}):0===T.length?e.jsx("div",{className:"col-span-full text-center py-8 text-white",children:C?"No templates found matching your search.":"No templates found. Create your first template!"}):T.map((s=>e.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-lg p-3 sm:p-4 hover:bg-white/10 transition-colors cursor-pointer group",onClick:()=>{x(s),p(!0)},children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-2 sm:gap-0 mb-2 sm:mb-3",children:[e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-white group-hover:text-[#9b1f62] transition-colors mb-1",children:s.name}),e.jsx("p",{className:"text-xs sm:text-sm text-white/70",children:s.subject})]}),e.jsxs("div",{className:"flex items-center gap-1 w-full sm:w-auto justify-end",children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),x(s),p(!0)},className:"p-2 text-white/70 hover:text-[#9b1f62] hover:bg-white/10 rounded-lg transition-colors",children:e.jsx(i,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsx("button",{onClick:e=>{e.stopPropagation(),(async e=>{if(confirm("Are you sure you want to delete this template?"))try{N(!0);const{error:t}=await a.from("email_templates").delete().eq("id",e);if(t)throw t;r.success("Template deleted successfully"),n(l.filter((t=>t.id!==e))),m?.id===e&&(x(null),p(!1))}catch(s){r.error("Error deleting template: "+s.message),t.error("Error deleting template:",s)}finally{N(!1)}})(s.id)},className:"p-2 text-white/70 hover:text-red-500 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx(c,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]}),e.jsxs("div",{className:"text-xs text-white/50",children:["Last updated: ",new Date(s.updated_at).toLocaleDateString()]})]},s.id)))})]})]})})})}export{p as default};
