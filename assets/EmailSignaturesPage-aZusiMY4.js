import{l as e,j as t}from"./index-Dj5MW5Ri.js";import{r as s}from"./react-vendor-BU_GpymC.js";import{s as r,n as a}from"./notifications-D-zVtaEK.js";function n(){const[n,i]=s.useState([]),[o,l]=s.useState(!0),[d,c]=s.useState(!1),[m,u]=s.useState(null),[x,h]=s.useState({name:"",content:"",is_default:!1});s.useEffect((()=>{g()}),[]);const g=async()=>{try{const{data:{user:e}}=await r.auth.getUser();if(!e)throw new Error("User not authenticated");const{data:t,error:s}=await r.from("email_signatures").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(s)throw s;i(t||[])}catch(t){a.error("Error fetching signatures"),e.error("Error:",t)}finally{l(!1)}};return t.jsxs("div",{className:"min-h-screen bg-gradient-to-r from-[#9b1f62] via-[#682161] to-[#3e3764] py-4 sm:py-6 px-3 sm:px-4",children:[t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl shadow-lg p-4 sm:p-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 sm:gap-6 mb-4 sm:mb-6",children:[t.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-white",children:"Email Signatures"}),t.jsxs("button",{onClick:()=>{u(null),h({name:"",content:"",is_default:!1}),c(!0)},className:"w-full sm:w-auto px-4 py-2 bg-[#9b1f62] text-white text-sm sm:text-base rounded-lg hover:bg-[#8a1b57] transition-colors duration-200 flex items-center justify-center",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Create Signature"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o?t.jsx("div",{className:"col-span-full text-center py-8 text-white/70",children:"Loading signatures..."}):0===n.length?t.jsx("div",{className:"col-span-full text-center py-8 text-white/70",children:"No signatures found. Create your first signature!"}):n.map((s=>t.jsxs("div",{className:"bg-white/5 rounded-lg p-3 sm:p-4 hover:bg-white/10 transition-colors duration-200",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-2 sm:gap-0 mb-2 sm:mb-3",children:[t.jsxs("div",{className:"w-full sm:w-auto",children:[t.jsx("h3",{className:"text-base sm:text-lg font-medium text-white mb-1",children:s.name}),s.is_default&&t.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:"Default"})]}),t.jsxs("div",{className:"flex items-center gap-1 w-full sm:w-auto justify-end",children:[t.jsx("button",{onClick:()=>(e=>{u(e),h({name:e.name,content:e.content,is_default:e.is_default}),c(!0)})(s),className:"p-2 text-white/70 hover:text-white transition-colors duration-200 rounded-lg hover:bg-white/5",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),t.jsx("button",{onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this signature?"))try{const{error:e}=await r.from("email_signatures").delete().eq("id",t);if(e)throw e;a.success("Signature deleted"),g()}catch(s){a.error("Error deleting signature"),e.error("Error:",s)}})(s.id),className:"p-2 text-white/70 hover:text-red-400 transition-colors duration-200 rounded-lg hover:bg-white/5",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),t.jsx("div",{className:"text-sm text-white/70 prose prose-invert max-w-none p-3 sm:p-4 bg-white/5 rounded-lg mt-2 sm:mt-3 overflow-hidden signature-preview",style:{wordBreak:"break-word",lineHeight:"1.5",maxHeight:"150px",overflowY:"auto"},dangerouslySetInnerHTML:{__html:s.content.replace(/\n/g,"<br>")}}),t.jsxs("div",{className:"mt-2 text-xs text-white/50",children:["Created ",new Date(s.created_at).toLocaleDateString()]})]},s.id)))})]})}),d&&t.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-3 sm:p-4 z-[60]",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto custom-scrollbar-light",children:[t.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 z-10",children:t.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-6",children:[t.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:m?"Edit Signature":"Create Signature"}),t.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700 p-1",children:t.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),t.jsx("div",{className:"p-4 sm:p-6",children:t.jsxs("form",{onSubmit:async t=>{t.preventDefault();try{const{data:{user:e}}=await r.auth.getUser();if(!e)throw new Error("User not authenticated");const t={...x,user_id:e.id};let s;if(({error:s}=m?await r.from("email_signatures").update(t).eq("id",m.id):await r.from("email_signatures").insert([t])),s)throw s;x.is_default&&await r.from("email_signatures").update({is_default:!1}).neq("id",m?.id||"new").eq("user_id",e.id),a.success(m?"Signature updated":"Signature created"),c(!1),u(null),h({name:"",content:"",is_default:!1}),g()}catch(s){a.error("Error saving signature"),e.error("Error:",s)}},className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Signature Name"}),t.jsx("input",{type:"text",value:x.name,onChange:e=>h((t=>({...t,name:e.target.value}))),required:!0,className:"w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-[#9b1f62] focus:border-[#9b1f62]",placeholder:"Enter signature name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Signature Content"}),t.jsx("textarea",{value:x.content,onChange:e=>h((t=>({...t,content:e.target.value}))),required:!0,rows:6,className:"w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-[#9b1f62] focus:border-[#9b1f62] font-mono",placeholder:"Enter signature content (HTML supported)"}),t.jsxs("p",{className:"mt-1 text-xs sm:text-sm text-gray-500",children:["HTML formatting is supported. Use ","{name}"," for dynamic name insertion."]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preview"}),t.jsx("div",{className:"w-full p-3 sm:p-4 border border-gray-200 rounded-lg bg-gray-50 min-h-[100px] prose max-w-none text-sm sm:text-base",style:{wordBreak:"break-word",lineHeight:"1.5"},dangerouslySetInnerHTML:{__html:x.content}})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",id:"is_default",checked:x.is_default,onChange:e=>h((t=>({...t,is_default:e.target.checked}))),className:"h-4 w-4 text-[#9b1f62] focus:ring-[#9b1f62] border-gray-300 rounded"}),t.jsx("label",{htmlFor:"is_default",className:"ml-2 block text-sm text-gray-700",children:"Set as default signature"})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>c(!1),className:"w-full sm:w-auto px-4 py-2 text-sm sm:text-base text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:"Cancel"}),t.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-sm sm:text-base bg-[#9b1f62] text-white rounded-lg hover:bg-[#8a1b57] transition-colors duration-200",children:m?"Save Changes":"Create Signature"})]})]})})]})})]})}export{n as default};
