import{l as e,j as s}from"./index-Dj5MW5Ri.js";import{r as t}from"./react-vendor-BU_GpymC.js";import{s as r,n as a}from"./notifications-D-zVtaEK.js";function l(){const[l,o]=t.useState([]),[i,n]=t.useState(!0),[d,c]=t.useState(!1),[m,x]=t.useState(null),[u,h]=t.useState({name:"",fields:[],success_message:"Thank you for your submission!",redirect_url:""});t.useEffect((()=>{f()}),[]);const f=async()=>{try{const{data:e,error:s}=await r.from("contact_forms").select("*").order("created_at",{ascending:!1});if(s)throw s;o(e||[])}catch(s){a.error("Error fetching forms"),e.error("Error:",s)}finally{n(!1)}},p=(e,s)=>{h((t=>({...t,fields:t.fields.map(((t,r)=>r===e?{...t,...s}:t))})))};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-r from-[#9b1f62] via-[#682161] to-[#3e3764] py-4 sm:py-6 px-3 sm:px-4",children:[s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl shadow-lg p-4 sm:p-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-0 mb-4 sm:mb-6",children:[s.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-white",children:"Contact Form Builder"}),s.jsx("button",{onClick:()=>{x(null),h({name:"",fields:[],success_message:"Thank you for your submission!",redirect_url:""}),c(!0)},className:"w-full sm:w-auto px-4 py-2 bg-[#9b1f62] text-white text-sm sm:text-base rounded-lg hover:bg-[#8a1b57] transition-colors duration-200",children:"Create Form"})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:i?s.jsx("div",{className:"col-span-full text-center py-6 sm:py-8 text-white/70",children:"Loading forms..."}):0===l.length?s.jsx("div",{className:"col-span-full text-center py-6 sm:py-8 text-white/70",children:"No forms found. Create your first form!"}):l.map((t=>s.jsxs("div",{className:"bg-white/5 rounded-lg p-3 sm:p-4 hover:bg-white/10 transition-colors duration-200",children:[s.jsxs("div",{className:"flex justify-between items-start gap-2 mb-3",children:[s.jsx("h3",{className:"text-base sm:text-lg font-medium text-white",children:t.name}),s.jsxs("div",{className:"flex space-x-2 shrink-0",children:[s.jsx("button",{onClick:()=>(e=>{x(e),h({name:e.name,fields:e.fields,success_message:e.success_message||"Thank you for your submission!",redirect_url:e.redirect_url||""}),c(!0)})(t),className:"p-1.5 text-white/70 hover:text-white transition-colors duration-200",children:s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),s.jsx("button",{onClick:()=>(async s=>{if(window.confirm("Are you sure you want to delete this form?"))try{const{error:e}=await r.from("contact_forms").delete().eq("id",s);if(e)throw e;a.success("Form deleted"),f()}catch(t){a.error("Error deleting form"),e.error("Error:",t)}})(t.id),className:"p-1.5 text-white/70 hover:text-red-400 transition-colors duration-200",children:s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"text-sm text-white/70",children:[t.fields.length," field",1===t.fields.length?"":"s"]}),s.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2",children:t.fields.map((e=>s.jsxs("span",{className:"inline-flex items-center px-1.5 sm:px-2 py-0.5 sm:py-1 rounded bg-white/10 text-xs text-white/90",children:[e.label,e.required&&s.jsx("span",{className:"text-red-400 ml-1",children:"*"})]},e.id)))})]}),s.jsxs("div",{className:"mt-3 text-xs text-white/50",children:["Created ",new Date(t.created_at).toLocaleDateString()]})]},t.id)))})]})}),d&&s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-start sm:items-center justify-center p-2 sm:p-4 z-[60] overflow-y-auto",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl my-4 sm:my-8",children:[s.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 z-10",children:s.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-6",children:[s.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:m?"Edit Form":"Create Form"}),s.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700 p-1",children:s.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),s.jsx("div",{className:"p-4 sm:p-6",children:s.jsxs("form",{onSubmit:async s=>{s.preventDefault();try{const{data:{user:e}}=await r.auth.getUser();if(!e)throw new Error("User not authenticated");const s={...u,created_by:e.id};let t;if(({error:t}=m?await r.from("contact_forms").update(s).eq("id",m.id):await r.from("contact_forms").insert([s])),t)throw t;a.success(m?"Form updated":"Form created"),c(!1),x(null),h({name:"",fields:[],success_message:"Thank you for your submission!",redirect_url:""}),f()}catch(t){a.error("Error saving form"),e.error("Error:",t)}},className:"space-y-4 sm:space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Form Name"}),s.jsx("input",{type:"text",value:u.name,onChange:e=>h((s=>({...s,name:e.target.value}))),required:!0,className:"w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-[#9b1f62] focus:border-[#9b1f62]",placeholder:"Enter form name"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-2 sm:gap-0 mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Form Fields"}),s.jsx("button",{type:"button",onClick:()=>{const e={id:`field_${Date.now()}`,name:"",label:"",type:"text",required:!1,placeholder:""};h((s=>({...s,fields:[...s.fields,e]})))},className:"w-full sm:w-auto inline-flex items-center justify-center px-3 py-1.5 bg-[#9b1f62] text-white text-sm rounded-lg hover:bg-[#8a1b57] transition-colors duration-200",children:"Add Field"})]}),s.jsxs("div",{className:"space-y-4",children:[u.fields.map(((e,t)=>s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4 relative",children:[s.jsx("button",{type:"button",onClick:()=>(e=>{h((s=>({...s,fields:s.fields.filter(((s,t)=>t!==e))})))})(t),className:"absolute top-2 right-2 text-gray-400 hover:text-red-500 p-1",children:s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Field Name"}),s.jsx("input",{type:"text",value:e.name,onChange:e=>p(t,{name:e.target.value}),required:!0,className:"w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-[#9b1f62] focus:border-[#9b1f62]",placeholder:"e.g., first_name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Field Label"}),s.jsx("input",{type:"text",value:e.label,onChange:e=>p(t,{label:e.target.value}),required:!0,className:"w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-[#9b1f62] focus:border-[#9b1f62]",placeholder:"e.g., First Name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Field Type"}),s.jsxs("select",{value:e.type,onChange:e=>p(t,{type:e.target.value}),required:!0,className:"w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-[#9b1f62] focus:border-[#9b1f62]",children:[s.jsx("option",{value:"text",children:"Text"}),s.jsx("option",{value:"email",children:"Email"}),s.jsx("option",{value:"phone",children:"Phone"}),s.jsx("option",{value:"textarea",children:"Text Area"}),s.jsx("option",{value:"select",children:"Select"}),s.jsx("option",{value:"checkbox",children:"Checkbox"}),s.jsx("option",{value:"radio",children:"Radio"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Placeholder"}),s.jsx("input",{type:"text",value:e.placeholder,onChange:e=>p(t,{placeholder:e.target.value}),className:"w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-[#9b1f62] focus:border-[#9b1f62]",placeholder:"Enter placeholder text"})]}),s.jsx("div",{className:"sm:col-span-2",children:s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",checked:e.required,onChange:e=>p(t,{required:e.target.checked}),className:"h-4 w-4 text-[#9b1f62] focus:ring-[#9b1f62] border-gray-300 rounded"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Required field"})]})})]})]},e.id))),0===u.fields.length&&s.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:'No fields added yet. Click "Add Field" to start building your form.'})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Success Message"}),s.jsx("input",{type:"text",value:u.success_message,onChange:e=>h((s=>({...s,success_message:e.target.value}))),required:!0,className:"w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-[#9b1f62] focus:border-[#9b1f62]",placeholder:"Message to show after successful submission"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Redirect URL (Optional)"}),s.jsx("input",{type:"url",value:u.redirect_url,onChange:e=>h((s=>({...s,redirect_url:e.target.value}))),className:"w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-[#9b1f62] focus:border-[#9b1f62]",placeholder:"https://example.com/thank-you"}),s.jsx("p",{className:"mt-1 text-xs sm:text-sm text-gray-500",children:"Leave empty to show the success message instead."})]}),s.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-2 sm:gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:()=>c(!1),className:"w-full sm:w-auto px-4 py-2 text-sm sm:text-base text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),s.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-sm sm:text-base bg-[#9b1f62] text-white rounded-lg hover:bg-[#8a1b57] transition-colors duration-200",children:m?"Save Changes":"Create Form"})]})]})})]})})]})}export{l as default};
